Перед запуском скрипта в папку \dist\main\data\ необходимо поместить исходный конфиг (заменяемого коммутатора), из которого будут получены данные по включенным портам, их дескрипторам, а также созданным вланам.

Скрипт можно запустить либо через launch.bat (рекомендуется), либо через \dist\main\main.exe

В начале работы скрипт запрашивает у пользователя ряд данных через командную строку. Данные необходимо указывать с соблюдением синтаксиса D-Link. Например, если необходимо указать список портов через запятую, то пробелы после запятых не используем. Все вводимые данные будут вставленны в генерируемый конфиг "как есть".
Скрипт запрашивает и использует данные на основе шаблона, который находится по пути \dist\main\data\template.txt
При необходимости template.txt может редактироваться сетевым инженером по своему усмотрению. В нем можно добавлять/удалять/изменять строчки с соблюдением следующих правил:
* в фигурных скобках указываются данные, которые нужно запросить у пользователя через диалог в начале работы скрипта
* в квадратных скобках используются данные, которые нужно получить на этапе заполнения ports.csv (подробнее ниже). Для использования нескольких "меток" в одном месте конфига нужно перечислить их внутри квадратных скобок через пробел.
Пример: 

config loopdetect port [l2 l3 trunk] state enabled

Скрипт подставит в строку конфига номера портов, помеченные в ports.csv как l2, l3 и trunk, перечислив их через запятую:

config loopdetect port 24,1,2,3,4,12 state enabled

Метки <ports> и <vlans> отвечают за блоки включения портов, создания и конфигурации вланов соответственно. Блоки создаются
согласно соответствующим данным полученным из ports.csv и
vlans.csv (подробнее ниже).
Блоки не предполагают редактирования без редактирования кода самого скрипта. Удаление или изменение меток <ports> и <vlans> вероятней всего приведет к неработоспобоности скрипта.
В пределах template.txt положение меток <ports> и <vlans> можно изменять. 

После получения необходимых данных скрипт откроет и предложит пользователю заполнить файл ports.csv. Данные будут использованы для замены данных в квадратных скобках в template.txt (см. выше).
Подразумевается, что здесь указывается тип предоставляемой услуги на порту, в зависимости от которой будут применены разные команды конфигурации, согласно template.txt

После нажатия Enter скрипт откроет и предложит проверить и при необходимости отредактировать файл vlans.csv. В нем указываются данные для заполнения блока <vlans> template.txt (ID, имя влана и соответствующие ему тегированные и нетегированные порты)
И во vlans.csv, и в ports.csv можно удалять старые и добавлять новые строчки вланов и портов соответственно.

После нажатия Enter скрипт на основе всех полученных данных создаст и откроет новый файл конфигурации. Файл будет автоматически сохранен в папке \dist\main\data\ под именем, которое пользователь указал ранее в начале работы скрипта.

Пример заполнения первоначального диалога:
 
